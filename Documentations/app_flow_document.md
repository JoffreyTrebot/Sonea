# App Flow Document for Relaxing App

## Onboarding and Sign-In/Sign-Up

When a new user opens the app for the first time, they are greeted by a full-screen splash image that fades gently into the login screen. On this screen, the user sees two clear paths: they can either sign in if they already have an account or register to create a new one. The registration path asks the user for an email address and a password, and once they submit, the app uses SupabaseService to securely create their account in the backend. If there is a problem—such as an already used email or a weak password—a concise inline error message appears under the form field, guiding them to correct it. Alongside the email/password form, there is an Apple Sign In button that follows Apple’s style guidelines; tapping this button brings up the native Apple authentication dialog, and upon success the SupabaseService exchanges the credentials and logs the user in. For users who forget their password, a “Forgot Password?” link leads to a simple form where they enter their email. A reset link is then emailed to them, and upon clicking it they can choose a new password before returning to the login screen. Once authentication succeeds through any of these methods, the app transitions immediately to the main interface. Signing out is handled from the Settings section: tapping “Sign Out” clears the user’s session and returns them to the login screen.

## Main Dashboard or Home Page

After signing in, the user arrives at the MainTabView, which serves as the home for all core functionality. The bottom tab bar presents four sections labeled Mixer, My Mixes, Downloads, and Settings. The Mixer tab is selected by default and shows a calming deep-violet background. The currently active tab icon and its label glow in a soft pastel purple, while the other tabs remain in a muted lavender shade, maintaining the app’s dreamy aesthetic. A header at the top of each screen may display the section title or context-sensitive controls such as the sleep timer on the Mixer screen. Switching between tabs is accompanied by a subtle fade or slide animation, reinforcing the smooth, relaxed mood of the experience.

## Detailed Feature Flows and Page Transitions

In the Mixer section, users see a scrollable list of available nature sounds fetched from Supabase Storage. Each sound entry shows a waveform preview and a volume slider. Tapping the play icon beside a sound triggers the AudioManager to either stream the track or play it from local storage if it has been downloaded, always using a gentle fade-in. Adjusting the volume slider changes the track’s volume in real time, and tapping the stop icon fades the track out. When users are happy with the combination of tracks, they tap a save icon in the header. A modal sheet then slides up, prompting them to enter a name for their mix. Pressing “Save” calls UserMixesViewModel to persist the mix configuration to Supabase, and a brief toast notification confirms the save before dismissing the sheet and returning to the Mixer canvas.

In the My Mixes section, saved mixes appear as vertically stacked, rounded cards that match the app’s soft UI language. Tapping any card instantly loads that mix back into the Mixer canvas and begins playback with smooth crossfades between its tracks. Swiping a mix card to the left reveals a delete button; tapping it prompts a confirmation alert. Confirming the deletion removes the mix from Supabase and from the local list. If the device is offline, the My Mixes view displays only those mixes that have been synced locally, and it shows a small offline icon in the header to reassure the user.

The Downloads section lists all sounds the user has chosen to keep offline. Each tile shows the track name, its file size, and the last played date. Tapping the tile toggles immediate playback of the local file with the same fade-in and fade-out transitions as streaming. Long-pressing a tile brings up a contextual menu with an option to delete that file, and choosing delete removes the file from local storage. Meanwhile, DownloadManager monitors overall cache size and automatically purges the least recently used files whenever the cache exceeds its predefined limit. When automatic deletion occurs, the UI updates in real time to reflect that certain sounds are no longer available offline.

On the Mixer screen, users can also set a sleep timer by tapping a clock icon in the header. This brings up a bottom sheet with a simple picker for hours and minutes. Once the user taps “Start Timer,” a countdown overlay appears at the top of the screen showing remaining time. When the timer runs out, AudioManager fades out all playing tracks and stops playback entirely—even if the device is locked—and a local notification lets the user know that their session has ended.

## Settings and Account Management

In the Settings section, users manage their personal preferences and account details. At the top, there is a toggle to switch between light and dark themes or follow the system appearance. Below that, controls allow the user to set a default timer duration and to enable or disable automatic deletion of old downloads. There is a GDPR-compliant analytics switch that users can opt in or out of basic event tracking and crash reporting; each option is accompanied by a short explanatory subtitle. Further down, the user can update their email or change their password through a secure form that again uses SupabaseService to apply the changes on the backend. At the bottom, an “App Version” label appears along with the “Sign Out” button that logs the user out and returns them to the login screen.

## Error States and Alternate Paths

If at any point the user enters invalid data—such as a malformed email or a password that is too weak—the app displays inline error text beneath the relevant form field. When network connectivity is lost during an API call, a full-screen banner or inline toast informs the user that they are offline; the app then operates in read-only mode for mixes and sounds that have been downloaded locally. Should a download or playback operation fail, a small alert dialog explains the issue and offers a retry button. Any unexpected crash or exception is captured by the integrated crash reporter, and if the user has opted into analytics, a prompt gives them the choice to send additional diagnostic information.

## Conclusion and Overall App Journey

From the moment a user installs Relaxing App, they are guided through a calm, straightforward sign-up flow and into the heart of the experience: mixing nature sounds to craft a personal soundscape. Each feature—from streaming and offline downloads to sleep timers and saved mixes—connects seamlessly through intuitive tabs and gentle animations. Users can tailor their listening environment, save their favorite combinations, and rely on automatic storage management to preserve space on their device. Through clear error handling, offline support, and GDPR-compliant analytics, the app ensures a dependable, worry-free experience. Ultimately, Relaxing App delivers a consistent journey from registration to daily relaxation, empowering users to create, save, and enjoy calming soundscapes at any time, even when they’re away from the internet or their screens are locked.